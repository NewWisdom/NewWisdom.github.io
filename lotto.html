<!DOCTYPE html>
<html>
<head>
    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Page Meta -->
    <title>🕹 Level 1. 로또 미션 코드 리뷰 정리</title>
    <meta name="description" content="블로그 이사중... 아직 정리가 안되었음..." />

    <!-- Mobile Meta -->
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Brand icon -->
    <link rel="shortcut icon" href="/assets/images/favicon.ico" >

    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css" />
    <link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&family=Roboto:wght@100&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans&display=swap" rel="stylesheet">
<link href="http://cdn.jsdelivr.net/gh/joungkyun/font-d2coding/d2coding.css" rel="stylesheet" type="text/css">
<!--Syntax Highlighter-->
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/androidstudio.min.css">
<style type='text/css'>
    pre, code {
        white-space: pre;
        overflow-x: scroll;
    }
    .hljs
{
    white-space: pre;
    overflow-x: auto;
}
</style>
<script>hljs.initHighlightingOnLoad();</script>
    <!-- Ghost outputs important style and meta data with this tag -->
        <link rel="canonical" href="http://localhost:4000//lotto" />
    <meta name="referrer" content="origin" />
    <link rel="next" href="/page2/" />

    <meta property="og:site_name" content="Welcome To New Wisdom's Log !" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="🕹 Level 1. 로또 미션 코드 리뷰 정리" />
    <meta property="og:description" content="블로그 이사중... 아직 정리가 안되었음..." />
    <meta property="og:url" content="http://localhost:4000//lotto" />
    <meta property="og:image" content="/assets/images/woowa.jpg" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="🕹 Level 1. 로또 미션 코드 리뷰 정리" />
    <meta name="twitter:description" content="블로그 이사중... 아직 정리가 안되었음..." />
    <meta name="twitter:url" content="http://localhost:4000//lotto" />
    <meta name="twitter:image:src" content="/assets/images/woowa.jpg" />

    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Website",
    "publisher": "Welcome To New Wisdom's Log !",
    "name": "🕹 Level 1. 로또 미션 코드 리뷰 정리",
    "url": "http://localhost:4000//lotto",
    "image": "/assets/images/woowa.jpg",
    "description": "블로그 이사중... 아직 정리가 안되었음..."
}
    </script>

    <meta name="generator" content="Jekyll 3.0.0" />
    <link rel="alternate" type="application/rss+xml" title="Welcome To New Wisdom's Log !" href="/feed.xml" />


</head>
<body class="home-template nav-closed">

    <!-- The blog navigation links -->
    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        <li class="nav-home " role="presentation"><a href="/">Home</a></li>
        <li class="nav-about " role="presentation"><a href="/about">About</a></li>
        <li class="nav-woowa " role="presentation"><a href="/tag/woowa">WoowaCource</a></li>
        <li class="nav-techotalk " role="presentation"><a href="/tag/techotalk">Techotalk</a></li>
        <li class="nav-java " role="presentation"><a href="/tag/java">Java</a></li>
        <li class="nav-kotlin " role="presentation"><a href="/tag/kotlin">Kotlin</a></li>
        <li class="nav-oop " role="presentation"><a href="/tag/oop">Oop</a></li>
        <li class="nav-springboot " role="presentation"><a href="/tag/springboot">SpringBoot</a></li>
        <li class="nav-ect " role="presentation"><a href="/tag/ect">Ect</a></li>
        <li class="nav-author " role="presentation"><a href="/author/casper">Casper</a></li>
        <li class="nav-author " role="presentation"><a href="/author/edgar">Edgar</a></li>
        <li class="nav-author " role="presentation"><a href="/author/abraham">Abraham</a></li>
        <li class="nav-author " role="presentation"><a href="/author/martin">Martin</a></li>
        <li class="nav-author " role="presentation"><a href="/author/lewis">Lewis</a></li>
    </ul>
    <a class="subscribe-button icon-feed" href="/feed.xml">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The comment above "< default" means - insert everything in this file into -->
    <!-- the [body] of the default.hbs template, which contains our header/footer. -->

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<header class="main-header post-head " style="background-image: url(/assets/images/woowa.jpg) ">
    <nav class="main-nav  overlay  clearfix">
        <a class="blog-logo" href="/"><img src="/assets/images/ghost.png" alt="Blog Logo" /></a>
        
            <a class="menu-button icon-menu" href="#"><span class="word">Menu</span></a>
        
    </nav>
    <div class = "amazzi">    
        <h1 class="post-title">🕹 Level 1. 로또 미션 코드 리뷰 정리</h1>
            <section class="post-meta">
            <!-- <a href='/'></a> -->

            
                
                    <a href='/author/amazzi'>✨ new wisdom ✨</a>
                
            
            <time class="post-date" datetime="2021-03-01">01 Mar 2021</time>
                <!-- [[tags prefix=" on "]] -->
                
                on
                
                    
                       <a href='/tag/woowa'>Woowa</a>
                    
                
                
            </section>
    </div>
</header>

<main class="content" role="main">

    <article class="post tag-woowa">

        <header class="post-header">
            
        </header>
        
        <br>

        <section class="post-content">

            <h2 id="1단계-피드백">1단계 피드백</h2>
<h3 id="객체인-controller">객체인 Controller</h3>
<p><img src="https://images.velog.io/images/new_wisdom/post/c00aaeae-a114-4634-ba8b-15d91ea499f6/image.png" style="zoom:50%;" /></p>

<p>LottoFactory를 인스턴스 변수로 두지 않았던 이유는 
Controller는 객체가 아니라 데이터를 가지면 안된다고 생각하고 있었다.<br />
당연히 Domain만 객체라고 생각했었다. (모르는건 부끄러운게 아니다 🥲)</p>

<p>하지만 생각해보니 Controller도 도메인과 뷰를 이어주는 동시에, 객체를 생성하는 책임이 있다.<br />
인스턴스 변수로 가지고 있게 된다면 getLottoTickets 메소드에서 매번 객체를 생성할 필요가 없다.</p>

<p>일단 이 코드에서 중요한 점은 어차피 지금 로또를 생성하는 책임을 컨트롤러에서 하고 있었으니<br />
“불필요한 객체 생성을 방지하도록 인스턴스 변수로만들어서 재활용하자”가 목적이다.</p>

<ul>
  <li><a href="https://github.com/woowacourse/java-lotto/commit/ab16861d71a72d2016ef4cd232a5cf5b5af86ac9">반영한 커밋</a>
    <h3 id="반복되는-상수-처리">반복되는 상수 처리</h3>
    <p><img src="https://images.velog.io/images/new_wisdom/post/acf1e691-e345-41ee-a67b-e249b23f6547/image.png" style="zoom:50%;" /></p>
  </li>
</ul>

<p><img src="https://images.velog.io/images/new_wisdom/post/3fd15906-7210-4084-bf94-32f8d9a2141a/image.png" style="zoom:50%;" /></p>

<p>미션 데드라인을 맞추기 위해 좀 더 꼼꼼히 확인을 못했던 부분인데,<br />
로또 티켓을 만드는 LottoTicketFactory에 있는 상수 값들이 LottoNumber나 LottoTicket등 여러 곳에서 중복되어 쓰이고 있었다.<br />
또 심지어 로또의 MAX 번호는 45인데, 49까지로 입력해 놓았다 🙃<br />
덕분에 상수값 하나라도 꼼꼼히 확인해야겠다는 깨달음을 얻었다.</p>

<p>중복되는 상수를 막으며, 각 객체가 알고 있어야 하는 값대로 상수를 두고<br />
이를 import 해서 사용하도록 수정했다.</p>

<h4 id="lottonumber">LottoNumber</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LottoNumber</span> <span class="kd">implements</span> <span class="n">Comparable</span><span class="o">&lt;</span><span class="n">LottoNumber</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MIN_LOTTO_NUMBER</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MAX_LOTTO_NUMBER</span> <span class="o">=</span> <span class="mi">45</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Pattern</span> <span class="n">NUMBER_PATTERN</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">"^[0-9]*$"</span><span class="o">);</span>
</code></pre></div></div>
<h4 id="lottoticket">LottoTicket</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LottoTicket</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LOTTO_TICKET_SIZE</span> <span class="o">=</span> <span class="mi">6</span><span class="o">;</span>
</code></pre></div></div>
<h4 id="lottofactory">LottoFactory</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">lotto</span><span class="o">.</span><span class="na">domain</span><span class="o">.</span><span class="na">LottoNumber</span><span class="o">.</span><span class="na">MAX_LOTTO_NUMBER</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">lotto</span><span class="o">.</span><span class="na">domain</span><span class="o">.</span><span class="na">LottoNumber</span><span class="o">.</span><span class="na">MIN_LOTTO_NUMBER</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">lotto</span><span class="o">.</span><span class="na">domain</span><span class="o">.</span><span class="na">LottoTicket</span><span class="o">.</span><span class="na">LOTTO_TICKET_SIZE</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">lotto</span><span class="o">.</span><span class="na">domain</span><span class="o">.</span><span class="na">Money</span><span class="o">.</span><span class="na">LOTTO_PRICE</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LottoTicketFactory</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">START_INDEX</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
</code></pre></div></div>
<ul>
  <li><a href="https://github.com/woowacourse/java-lotto/commit/95988ad3982c06c1d6b105db83bd0fa9b559260a">반영한 커밋</a>
    <h3 id="구매-금액-계산-법">구매 금액 계산 법</h3>
    <p><img src="https://images.velog.io/images/new_wisdom/post/1c7743ed-6856-4410-809d-aa6c383c680d/image.png" style="zoom:50%;" /></p>
  </li>
</ul>

<p>리팩토링 전 로직으로는 구매 금액을 입력 받을 때 만약 14500원이 들어오면 사용한 금액은<br />
14장을 사는데 14000원만 들게 하고 500원이 남는 것은 예외라고 생각하지 않고 진행했다.<br />
그런데 이 로직은 구매한 금액이 아닌 지불한 14500원으로 수익률을 계산하고 있다.<br />
때문에 입력 금액과 구매 금액의 미일치 오류가 발생한다.</p>

<p>피드백을 통해 lottoResult에서 구할 수 있는 티켓 개수와 상수 변수인 로또의 구매장수로<br />
지불 금액을 구할 수 있음을 깨닫고 <code class="highlighter-rouge">showResult()</code> 에서 <code class="highlighter-rouge">money</code>를 매개변수로 받을 필요가 없음을 깨달았다.</p>

<p>덕분에 money와의 연관관계를 하나 끊을 수 있고, <br />
수익금 계산 시 입력 금액과 구매 금액 미일치로 인한 수익률 에러를 방지할 수 있다.</p>

<ul>
  <li><a href="https://github.com/woowacourse/java-lotto/commit/06cf1861eab0fcd0900218e06c38024fcae2d957">반영한 커밋</a></li>
</ul>

<h3 id="prize에서의-static-메서드-사용">Prize에서의 static 메서드 사용</h3>

<p><img src="https://images.velog.io/images/new_wisdom/post/1c8c1eac-ab18-4280-b3ad-e5ab1ff285bb/image.png" style="zoom:50%;" /></p>

<h4 id="리팩토링-전-prize">리팩토링 전 Prize</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Prize</span> <span class="nf">getPrizeType</span><span class="o">(</span><span class="kt">int</span> <span class="n">matchCount</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">isBonusBall</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">isMatchCountEqualsPivot</span><span class="o">(</span><span class="n">matchCount</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">isBonusBall</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">SECOND_PRIZE</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">values</span><span class="o">())</span>
                <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">s</span> <span class="o">-&gt;</span> <span class="n">s</span><span class="o">.</span><span class="na">matchCount</span> <span class="o">==</span> <span class="n">matchCount</span><span class="o">)</span>
                <span class="o">.</span><span class="na">findFirst</span><span class="o">()</span>
                <span class="o">.</span><span class="na">orElse</span><span class="o">(</span><span class="n">NO_PRIZE</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isMatchCountEqualsPivot</span><span class="o">(</span><span class="kt">int</span> <span class="n">matchCount</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">matchCount</span> <span class="o">==</span> <span class="n">BONUS_CHECK_PIVOT</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">double</span> <span class="nf">calculatePrizeMoneySum</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Prize</span><span class="o">&gt;</span> <span class="n">lottoResults</span><span class="o">,</span> <span class="n">Money</span> <span class="n">money</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Money</span> <span class="n">moneySum</span> <span class="o">=</span> <span class="n">Money</span><span class="o">.</span><span class="na">ZERO</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Prize</span> <span class="n">prize</span> <span class="o">:</span> <span class="n">Prize</span><span class="o">.</span><span class="na">values</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">Money</span> <span class="n">perPrizeMoneySum</span> <span class="o">=</span> <span class="n">prize</span><span class="o">.</span><span class="na">prizeMoney</span>
                    <span class="o">.</span><span class="na">multiple</span><span class="o">(</span><span class="n">getCountByPrizeType</span><span class="o">(</span><span class="n">lottoResults</span><span class="o">,</span> <span class="n">prize</span><span class="o">));</span>
            <span class="n">moneySum</span> <span class="o">=</span> <span class="n">moneySum</span><span class="o">.</span><span class="na">plus</span><span class="o">(</span><span class="n">perPrizeMoneySum</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">moneySum</span><span class="o">.</span><span class="na">getRate</span><span class="o">(</span><span class="n">money</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">getCountByPrizeType</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Prize</span><span class="o">&gt;</span> <span class="n">lottoResults</span><span class="o">,</span> <span class="n">Prize</span> <span class="n">prize</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">lottoResults</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
                <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">p</span> <span class="o">-&gt;</span> <span class="n">p</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">prize</span><span class="o">))</span>
                <span class="o">.</span><span class="na">count</span><span class="o">();</span>
    <span class="o">}</span>

</code></pre></div></div>

<h4 id="리팩토링-전-lottoresult">리팩토링 전 LottoResult</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LottoResult</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Prize</span><span class="o">&gt;</span> <span class="n">lottoResults</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">LottoResult</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Prize</span><span class="o">&gt;</span> <span class="n">lottoResults</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">lottoResults</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;(</span><span class="n">lottoResults</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">calculateProfitRate</span><span class="o">(</span><span class="n">Money</span> <span class="n">money</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">Prize</span><span class="o">.</span><span class="na">calculatePrizeMoneySum</span><span class="o">(</span><span class="n">lottoResults</span><span class="o">,</span> <span class="n">money</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getCountPerPrizeType</span><span class="o">(</span><span class="n">Prize</span> <span class="n">prize</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">Prize</span><span class="o">.</span><span class="na">getCountByPrizeType</span><span class="o">(</span><span class="n">lottoResults</span><span class="o">,</span><span class="n">prize</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>LottoResult에서 <code class="highlighter-rouge">calculateProfitRate()</code>을 하기 위해  Prize의 도움을 받았다.<br />
lottoResults가 Prize의 도움을 받지 않고 <code class="highlighter-rouge">List&lt;Prize&gt; lottoResults</code> 
각각의 prize에게 메시지를 보내 스스로 계산할 수 있도록 코드를 다음과 같이 수정했었다.</p>

<h4 id="lottoresult">LottoResult</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">public</span> <span class="n">Money</span> <span class="nf">getTotalProfit</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">Money</span> <span class="n">totalProfit</span> <span class="o">=</span> <span class="n">Money</span><span class="o">.</span><span class="na">ZERO</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Prize</span> <span class="n">prize</span> <span class="o">:</span> <span class="n">lottoResults</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">totalProfit</span> <span class="o">=</span> <span class="n">totalProfit</span><span class="o">.</span><span class="na">plus</span><span class="o">(</span><span class="n">prize</span><span class="o">.</span><span class="na">getPrizeMoney</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">totalProfit</span><span class="o">;</span>
    <span class="o">}</span>
</code></pre></div></div>
<ul>
  <li><a href="https://github.com/woowacourse/java-lotto/commit/af0f1ff2915d6420b6935e1baa9510c1030c7daf">1차 반영 커밋</a></li>
</ul>

<p>하지만 리팩토링 후에도 아직 객체 스스로 할 수 있는일들이 남아있었다.</p>

<p><img src="https://images.velog.io/images/new_wisdom/post/acb68cb8-5309-4c65-a040-2babdc96a770/image.png" style="zoom:50%;" /></p>

<p>또 이때까지 로또 티켓과 당첨 티켓을 비교해 결과를 반환하는 책임을 <br />
lott. Tickets가 가지고 있었다.<br />
곰곰히 생각해보니 로또 티켓과 당첨 티켓을 비교해 결과를 반환하는 책임은 winningLotto가 맡는 것이 더 적합하다고 판단이 되었고,<br />
winningLotto에서 prize를 체크하도록 책임을 이동하였다.</p>

<p>최종적으로 LottoResult를 반환하는 것은 winnigLotto에서 담당하며,<br />
또 Prize의 도움을 받지 않고 스스로 prize를 체크하도록 하였다.</p>

<h4 id="리팩토링한-winniglotto의-메소드-일부">리팩토링한 WinnigLotto의 메소드 일부</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">Prize</span> <span class="nf">matchPrize</span><span class="o">(</span><span class="n">LottoTicket</span> <span class="n">lottoTicket</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">matchCount</span> <span class="o">=</span> <span class="n">getMatchingCount</span><span class="o">(</span><span class="n">lottoTicket</span><span class="o">);</span>
    <span class="kt">boolean</span> <span class="n">isBonusNumber</span> <span class="o">=</span> <span class="n">isContainBonusNumber</span><span class="o">(</span><span class="n">lottoTicket</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">Prize</span><span class="o">.</span><span class="na">findPrize</span><span class="o">(</span><span class="n">matchCount</span><span class="o">,</span> <span class="n">isBonusNumber</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kt">int</span> <span class="nf">getMatchingCount</span><span class="o">(</span><span class="n">LottoTicket</span> <span class="n">lottoTicket</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">lottoTicket</span><span class="o">.</span><span class="na">lottoTicket</span><span class="o">().</span><span class="na">stream</span><span class="o">()</span>
            <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">winningTicket</span><span class="o">.</span><span class="na">lottoTicket</span><span class="o">()::</span><span class="n">contains</span><span class="o">)</span>
            <span class="o">.</span><span class="na">count</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">isContainBonusNumber</span><span class="o">(</span><span class="n">LottoTicket</span> <span class="n">lottoTicket</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">lottoTicket</span><span class="o">.</span><span class="na">lottoTicket</span><span class="o">()</span>
            <span class="o">.</span><span class="na">stream</span><span class="o">()</span>
            <span class="o">.</span><span class="na">anyMatch</span><span class="o">(</span><span class="n">lottoNumber</span> <span class="o">-&gt;</span> <span class="n">lottoNumber</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">bonusNumber</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>
<h4 id="리팩토링-후-prize에서-줄어든-static-메소드들">리팩토링 후 Prize에서 줄어든 static 메소드들</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">Prize</span> <span class="nf">findPrize</span><span class="o">(</span><span class="kt">int</span> <span class="n">matchCount</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">isBonusNumber</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">isMatchCountEqualsPivot</span><span class="o">(</span><span class="n">matchCount</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">isBonusNumber</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">SECOND_PRIZE</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">values</span><span class="o">())</span>
            <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">s</span> <span class="o">-&gt;</span> <span class="n">s</span><span class="o">.</span><span class="na">matchCount</span> <span class="o">==</span> <span class="n">matchCount</span><span class="o">)</span>
            <span class="o">.</span><span class="na">findFirst</span><span class="o">()</span>
            <span class="o">.</span><span class="na">orElse</span><span class="o">(</span><span class="n">NO_PRIZE</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isMatchCountEqualsPivot</span><span class="o">(</span><span class="kt">int</span> <span class="n">matchCount</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">matchCount</span> <span class="o">==</span> <span class="n">BONUS_CHECK_PIVOT</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="n">Money</span> <span class="nf">getPrizeMoney</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">prizeMoney</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kt">int</span> <span class="nf">getMatchCount</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">matchCount</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li><a href="https://github.com/woowacourse/java-lotto/commit/df62ef0a1e9ef8bf680d03556a0c44886d252c24">반영한 커밋1</a></li>
  <li><a href="https://github.com/woowacourse/java-lotto/commit/e0acff81ab0893813483949504c22bd954271a46">반영한 커밋2</a></li>
</ul>

<h3 id="collectingandthen">collectingAndThen</h3>

<p><img src="https://images.velog.io/images/new_wisdom/post/40036589-2ae0-4833-a4ed-8bf372d68844/image.png" style="zoom:50%;" /></p>

<p>리뷰어님께서 수정해주신 코드는 <code class="highlighter-rouge">collectingAndThen</code>메소드를 사용했는데,<br />
처음보는 메소드라 찾아보니 collecting을 진행한 후 그 결과로 메소드를 호출할 수 있는 메서드 였다.<br />
stream map을 써서 객체 하나하나를 생성하고 이를 리스트로 바꿔,<br />
또 객체를 생성하는 나의 로직에서 이 메서드를 사용하면<br />
좀 더 간결하게 표현할 수 있었다.<br />
사용법을 배웠으니, 앞으로 자주 사용할 것이다 👀<br />
또 Collections의 다양한 API를 살펴보아야겠다.</p>

<ul>
  <li><a href="https://www.baeldung.com/java-8-collectors">참고</a></li>
</ul>

<h2 id="2단계-초기-리팩토링">2단계 초기 리팩토링</h2>
<p><img src="https://images.velog.io/images/new_wisdom/post/b07190ba-4871-4c44-8f25-b7c17d1da072/image.png" style="zoom:50%;" /></p>

<h3 id="lottocount-객체-추가">LottoCount 객체 추가</h3>
<p>이번 리팩토링에서 <code class="highlighter-rouge">수동 로또 개수</code>를 입력 받고, 이 갯수 만큼 로또를 생성하고 출력해야했다.<br />
원시값 포장의 의미도 담으면서 입력 받는 수동 로또 갯수에 대한 검증하고, <br />
이에 대한 상태와 행위를 한 곳에서 관리 하기 위해 <code class="highlighter-rouge">LottoCount</code> 객체를 만들게 되었다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LottoCount</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">manualCount</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">autoCount</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">LottoCount</span><span class="o">(</span><span class="kt">int</span> <span class="n">manualCount</span><span class="o">,</span> <span class="kt">int</span> <span class="n">totalCount</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">validateLottoCount</span><span class="o">(</span><span class="n">manualCount</span><span class="o">,</span> <span class="n">totalCount</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">manualCount</span> <span class="o">=</span> <span class="n">manualCount</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">autoCount</span> <span class="o">=</span> <span class="n">totalCount</span> <span class="o">-</span> <span class="k">this</span><span class="o">.</span><span class="na">manualCount</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">validateLottoCount</span><span class="o">(</span><span class="kt">int</span> <span class="n">manualCount</span><span class="o">,</span> <span class="kt">int</span> <span class="n">totalCount</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">manualCount</span> <span class="o">&gt;</span> <span class="n">totalCount</span> <span class="o">||</span> <span class="n">manualCount</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"[ERROR] 구매 가능한 로또 개수 범위가 아닙니다."</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getManualCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">manualCount</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getAutoCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">autoCount</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="exception">Exception</h3>
<p>화요일 강의인 Exception이 내게는 많은 배움을 주어서, <br />
이번 요구사항인 사용자 입력값에 대한 예외처리를 신경썼다.<br />
이전에는 Custom Exception을 만들어서 각 객체마다 예외 처리를 해주었으나,</p>

<ul>
  <li>리팩토링 전 Custom Class
```java
package lotto.exception;</li>
</ul>

<p>import lotto.view.ErrorView;</p>

<p>public class IllegalMoneyException extends IllegalArgumentException {
    public IllegalMoneyException() {
        ErrorView.printIllegalMoneyErrorMessage();
    }
}</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>각 Custom Exception 클래스가 따로 처리하는 일이 없고,   
메세지도 super에게 전달하는 것이 아닌 `ErrorView`라는 객체를 통해 출력하고 있기 때문에    
필요성을 못느끼게 되어 자바의 기본 예외를 사용하도록 리팩토링을 진행했다.  
또 객체 단위로 묶어서 에러 메세지를 보내던 부분은   
각 예외 사항에 맞게 에러 메시지를 보내도록 수정했다.  

#### LottoTicketFactory -&gt; AutoNumbersFactory
요구사항에 따라 리팩토링을 진행하면서 `LottoTickets`를 생성해내던 LottoTicketfactory의 역할에 대한 의문이 들었다.   
처음 리팩토링에서는 객체를 많이 변경하지 않기 위해 수동 로또 번호들을 받고 자동 로또 갯수를 받아서  
`LottoTicketFactory`에서 자동 로또 숫자들을 만들고 `LottoTickets`를 생성하는 역할로 진행했는데,  
로또 티켓들 객체를 생성하기 위해 또 다른 `LottoTicketFactory`를 생성하는 것이 좋지 못한 방안이라는 생각이 들었다.  

때문에 LottoTickets 객체를 생성할 때 로또 번호들의 리스트들을 받아서   
(`List&lt;List&lt;LottoNumber&gt;&gt; lottoNumbersGroup`) `LottoTickets` 안에서 로또 티켓들을 생성하는 방식으로 변경했다.
그리고 기존 `LottoTicketFactory`는 `AutoNumbersFactory`로 변경하여  
자동 로또 숫자 리스트를 만들어내는 역할로 변경해보았다 !   

#### LottoNumber
0223 수업 때 로또 넘버의 범위에 제한이 있으니, 이를 미리 캐싱해서 사용하는 방법을 생각해보라고 하셨다.  
생각을 해보고 캐싱하는 방법을 찾아보니 `HashMap`을 이용해서 캐싱을 구현할 수 있음을 깨달았다.  
이로 생성자를 `private`로 막아 불필요한 객체 생성을 막고,   
`static block`에 의해 미리 캐싱된 `LottoNumber`에서 키값으로 접근해 해당 로또넘버를 가져오는 형식으로 리팩토링을 진행했다.  

* LottoNumber 캐시 적용 부분
```java
static {
    IntStream.range(MIN_LOTTO_NUMBER, MAX_LOTTO_NUMBER + 1)
            .forEach(i -&gt; CACHE_LOTTO_NUMBERS.put(i, new LottoNumber(i)));
}

public static LottoNumber valueOf(int index) {
    validateLottoNumber(index);
    return CACHE_LOTTO_NUMBERS.get(index);
}
</code></pre></div></div>

<h2 id="2단계-피드백">2단계 피드백</h2>

<h3 id="정적-팩터리-메소드">정적 팩터리 메소드</h3>
<p><img src="https://images.velog.io/images/new_wisdom/post/6f036cee-daa9-49b9-95c1-5b1925020fd1/image.png" style="zoom:50%;" /></p>

<p>정적 팩터리 메서드에 대해 정리는 했었으나,<br />
사실 언제 써야하고 언제 쓰지 말아야할지 아직 감이 안왔다 해야하나 🥲</p>

<p>그런데 크루들이랑 얘기를 해보니, <br />
정답은 없으나 자신이 쓰는 명분을 가지는게 좋을 것 같다는 결론을 내렸다.<br />
사실 이때까지 정적 팩터리 메서드의 사용성을 제대로 인지하지 못하고 있었던 것 같다.<br />
static이라는 명분 때문에 객체를 공유한다고 생각했으나,<br />
정적 팩터리 메서드 내에서 새로운 객체를 생성해 반환한다면<br />
상태를 공유하지 않는 것이다.</p>

<p>왜 static이라는 명목 때문에 정적 팩터리 메서드가 무조건<br />
공유되는 객체를 만든다고만 생각했을까 🥲</p>

<p>때문에 이번 리팩토링에서는 정적 팩터리 메서드를 적극 사용해 보았다.</p>

<h3 id="많은-책임을-지고-있던-lottocontroller">많은 책임을 지고 있던 LottoController</h3>
<p><img src="https://images.velog.io/images/new_wisdom/post/12a6e507-efd1-4f00-9ba6-fd9c57bb9ab3/image.png" style="zoom:50%;" /></p>

<p>이 당시 내가 구현한 LottoController는</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="n">LottoTickets</span> <span class="nf">buyLottoTickets</span><span class="o">(</span><span class="n">LottoCount</span> <span class="n">lottoCount</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">LottoNumber</span><span class="o">&gt;&gt;</span> <span class="n">lottoNumbersGroup</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="n">lottoNumbersGroup</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">createAllManualLottoTicket</span><span class="o">(</span><span class="n">lottoCount</span><span class="o">.</span><span class="na">getManualLottoCount</span><span class="o">()));</span>
    <span class="n">lottoNumbersGroup</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">createAutoNumbers</span><span class="o">(</span><span class="n">lottoCount</span><span class="o">.</span><span class="na">getAutoLottoCount</span><span class="o">()));</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">LottoTickets</span><span class="o">(</span><span class="n">lottoNumbersGroup</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p>이런식으로 LottoTicket에 해당하는 <code class="highlighter-rouge">List&lt;LottoNumber&gt;</code>도 Controller에서 만들고,<br />
이를 가지고 LottoTickets까지 만들어 낸다.<br />
또 보다싶이 <code class="highlighter-rouge">List&lt;List&lt;LottoNumber&gt;&gt;</code>를 만들어 내기 위해 복잡한 코드를 가지고 있었다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">LottoNumber</span><span class="o">&gt;&gt;</span> <span class="nf">createAllManualLottoTicket</span><span class="o">(</span><span class="kt">int</span> <span class="n">manualLottoCount</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">OutputView</span><span class="o">.</span><span class="na">printInputManualLottoNumbers</span><span class="o">();</span>
    <span class="k">return</span> <span class="n">IntStream</span><span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">manualLottoCount</span><span class="o">)</span>
            <span class="o">.</span><span class="na">mapToObj</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">InputView</span><span class="o">.</span><span class="na">inputNumbers</span><span class="o">()</span>
                    <span class="o">.</span><span class="na">stream</span><span class="o">()</span>
                    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">input</span> <span class="o">-&gt;</span> <span class="n">LottoNumber</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ParseUtil</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">input</span><span class="o">)))</span>
                    <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>
<p>이에 대해 남겨주신 피드백은 다음과 같다.</p>

<p><img src="https://images.velog.io/images/new_wisdom/post/001e2dd8-9190-4b5f-a7de-2517dd7e6387/image.png" style="zoom:50%;" /></p>

<p><img src="https://images.velog.io/images/new_wisdom/post/3d3587e8-af0a-43a5-a164-a3fc966295f0/image.png" style="zoom:50%;" /></p>

<p><img src="https://images.velog.io/images/new_wisdom/post/9413baaf-ec08-45c4-a999-d47ef4092193/image.png" style="zoom:50%;" /></p>

<p>이로 인해 전반적으로 많은 수정이 일어났다.<br />
LottoTicket에 <code class="highlighter-rouge">auto()</code>, <code class="highlighter-rouge">manual()</code> 정적 팩터리 메서드를 만들고,<br />
LottoTickets에도 <code class="highlighter-rouge">auto()</code> 정적 팩터리 메서드를 만들어 <br />
LottoController에서 생성하고 있던 책임을 분배했다.</p>

<h4 id="lottoticket---auto-manual">LottoTicket - auto(), manual()</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">LottoTicket</span> <span class="nf">auto</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">LottoTicket</span><span class="o">(</span><span class="n">LottoNumbersFactory</span><span class="o">.</span><span class="na">generateAutoLottoNumbers</span><span class="o">());</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="n">LottoTicket</span> <span class="nf">manual</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">lottoNumberStrings</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">lottoNumberStrings</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">LottoNumber</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ParseUtil</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">i</span><span class="o">)))</span>
            <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">collectingAndThen</span><span class="o">(</span><span class="n">toList</span><span class="o">(),</span> <span class="nl">LottoTicket:</span><span class="o">:</span><span class="k">new</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>
<p>LottoTicket에서 <code class="highlighter-rouge">List&lt;String&gt;</code>을 받아 수동 로또 티켓을 생성하도록 리팩토링 해보았다 !</p>
<h4 id="lottotickets---auto">LottoTickets - auto()</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">LottoTickets</span> <span class="nf">auto</span><span class="o">(</span><span class="kt">int</span> <span class="n">count</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">Stream</span><span class="o">.</span><span class="na">generate</span><span class="o">(</span><span class="nl">LottoTicket:</span><span class="o">:</span><span class="n">auto</span><span class="o">)</span>
            <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="n">count</span><span class="o">)</span>
            <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">collectingAndThen</span><span class="o">(</span><span class="n">toList</span><span class="o">(),</span> <span class="nl">LottoTickets:</span><span class="o">:</span><span class="k">new</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>
<p>덕분에 LottoContoller에 있던 많은 책임이 분배되었다고 생각하고(?),
각 메서드 코드도 간결해졌다고 느낀다.</p>

<h4 id="lottocontroller-일부">LottoController 일부</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="n">LottoTickets</span> <span class="nf">buyLottoTickets</span><span class="o">(</span><span class="n">LottoCount</span> <span class="n">lottoCount</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">LottoTickets</span> <span class="n">lottoTickets</span> <span class="o">=</span> <span class="n">createManualLottoTickets</span><span class="o">(</span><span class="n">lottoCount</span><span class="o">.</span><span class="na">getManualCount</span><span class="o">());</span>
    <span class="n">lottoTickets</span><span class="o">.</span><span class="na">combine</span><span class="o">(</span><span class="n">LottoTickets</span><span class="o">.</span><span class="na">auto</span><span class="o">(</span><span class="n">lottoCount</span><span class="o">.</span><span class="na">getAutoCount</span><span class="o">()));</span>
    <span class="k">return</span> <span class="n">lottoTickets</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="n">LottoTickets</span> <span class="nf">createManualLottoTickets</span><span class="o">(</span><span class="kt">int</span> <span class="n">manualCount</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">OutputView</span><span class="o">.</span><span class="na">printInputManualLottoNumbers</span><span class="o">();</span>
    <span class="k">return</span> <span class="n">Stream</span><span class="o">.</span><span class="na">generate</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="n">LottoTicket</span><span class="o">.</span><span class="na">manual</span><span class="o">(</span><span class="n">InputView</span><span class="o">.</span><span class="na">inputNumbers</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="n">manualCount</span><span class="o">)</span>
                <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">collectingAndThen</span><span class="o">(</span><span class="n">toList</span><span class="o">(),</span> <span class="nl">LottoTickets:</span><span class="o">:</span><span class="k">new</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="lottotickets">LottoTickets</h3>
<p><img src="https://images.velog.io/images/new_wisdom/post/3f3db20b-c6f6-4134-b43c-35174ea78954/image.png" style="zoom:50%;" /></p>

<p>피드백을 듣고 생각해보니 LottoTickets를 나는 단순히 LottoTicket의 모음이라고만 생각했었다.<br />
(약간 Repository로 생각했던 것 같다.)</p>

<h4 id="리펙토링-전-lottotickets">리펙토링 전 LottoTickets</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">LottoTicket</span><span class="o">&gt;</span> <span class="n">lottoTickets</span><span class="o">;</span>

<span class="kd">public</span> <span class="nf">LottoTickets</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">LottoNumber</span><span class="o">&gt;&gt;</span> <span class="n">lottoNumbersGroup</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">lottoTickets</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;(</span><span class="n">createLottoTickets</span><span class="o">(</span><span class="n">lottoNumbersGroup</span><span class="o">));</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">LottoTicket</span><span class="o">&gt;</span> <span class="nf">lottoTickets</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">Collections</span><span class="o">.</span><span class="na">unmodifiableList</span><span class="o">(</span><span class="n">lottoTickets</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">LottoTicket</span><span class="o">&gt;</span> <span class="nf">createLottoTickets</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">LottoNumber</span><span class="o">&gt;&gt;</span> <span class="n">lottoNumbersGroup</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">lottoNumbersGroup</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">LottoTicket:</span><span class="o">:</span><span class="k">new</span><span class="o">)</span>
            <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>

<p>고민해보니 이전에 아래와 같이 WinningTicket에서 당첨 결과를 산출했었는데,</p>
<h4 id="리펙토링-전-winniglotto">리펙토링 전 WinnigLotto</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">LottoResult</span> <span class="nf">checkPrizes</span><span class="o">(</span><span class="n">LottoTickets</span> <span class="n">lottoTickets</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">lottoTickets</span><span class="o">.</span><span class="na">lottoTickets</span><span class="o">().</span><span class="na">stream</span><span class="o">()</span>
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="k">this</span><span class="o">::</span><span class="n">matchPrize</span><span class="o">)</span>
            <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">collectingAndThen</span><span class="o">(</span><span class="n">toList</span><span class="o">(),</span> <span class="nl">LottoResult:</span><span class="o">:</span><span class="k">new</span><span class="o">));</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="n">Prize</span> <span class="nf">matchPrize</span><span class="o">(</span><span class="n">LottoTicket</span> <span class="n">lottoTicket</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">matchCount</span> <span class="o">=</span> <span class="n">getMatchingCount</span><span class="o">(</span><span class="n">lottoTicket</span><span class="o">);</span>
    <span class="kt">boolean</span> <span class="n">isBonusNumber</span> <span class="o">=</span> <span class="n">isContainBonusNumber</span><span class="o">(</span><span class="n">lottoTicket</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">Prize</span><span class="o">.</span><span class="na">findPrize</span><span class="o">(</span><span class="n">matchCount</span><span class="o">,</span> <span class="n">isBonusNumber</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kt">int</span> <span class="nf">getMatchingCount</span><span class="o">(</span><span class="n">LottoTicket</span> <span class="n">lottoTicket</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">lottoTicket</span><span class="o">.</span><span class="na">lottoTicket</span><span class="o">().</span><span class="na">stream</span><span class="o">()</span>
                <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">winningTicket</span><span class="o">.</span><span class="na">lottoTicket</span><span class="o">()::</span><span class="n">contains</span><span class="o">)</span>
                <span class="o">.</span><span class="na">count</span><span class="o">();</span>
<span class="o">}</span>

    <span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">isContainBonusNumber</span><span class="o">(</span><span class="n">LottoTicket</span> <span class="n">lottoTicket</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">lottoTicket</span><span class="o">.</span><span class="na">lottoTicket</span><span class="o">()</span>
                <span class="o">.</span><span class="na">stream</span><span class="o">()</span>
                <span class="o">.</span><span class="na">anyMatch</span><span class="o">(</span><span class="n">lottoNumber</span> <span class="o">-&gt;</span> <span class="n">lottoNumber</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">bonusNumber</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>

<p>이렇게 모든 메서드에서 LottoTicket의 값을 꺼내오고 있었다.<br />
때문에 LottoTickets에 WinnigLotto를 주어 각 LottoTicket에게 비교하라는 메시지를 주는것이 더 옳다고 생각해서<br />
LottoTickets에서 결과를 비교하는 역할을 부여하게 되었다.</p>

<p>또 Controller에서 로또 티켓을 생성하는 역할을 덜기 위해 메서드들이 바로 LottoTickets를 반환하도록 하면서<br />
<code class="highlighter-rouge">ManualLottoTickets</code>와 <code class="highlighter-rouge">LottoTickets.auto</code>를생성하는데<br />
생성된 이 두 <code class="highlighter-rouge">LottoTickets</code>들을 합치는 역할도 필요하다고 생각해서 <br />
<code class="highlighter-rouge">combine()</code>할 수 있는 기능을 추가했다.</p>

<p>그런데 WinnigLotto에 있던 것들을 LottoTickets로 분배하니 WinningLotto의<br />
역할이 다 빼앗겨 버린건 아닐까 고민이 되었지만,</p>

<p><img src="https://images.velog.io/images/new_wisdom/post/044fae6a-acce-474a-8d3d-5b031dfe7196/image.png" style="zoom:50%;" /></p>

<p>리뷰어 분께서 괜찮다고 말씀해주셨다.</p>

<p>미션을 진행하면 할수록 아직 배울 것이 많고 나의 부족함을 느낀다.<br />
배울 것이 많다는 것은 느낄 성취감이 많다는 것이니 앞으로 화이팅하자 🏃‍♂️</p>


        </section>

        <footer class="post-footer">

            <!-- Everything inside the #author tags pulls data from the author -->
            <!-- #author-->
            
                
                    
                        <figure class="author-image">
                            <a class="img" href="/author/amazzi" style="background-image: url(/assets/images/amazzi.jpeg)"><span class="hidden">amazzi's Picture</span></a>
                        </figure>
                    

                    <section class="author">
                        <h4><a href="/author/amazzi">✨ new wisdom ✨</a></h4>

                        
                            <p> I want to be a person who gives you new wisdom.</p>
                        
                        <div class="author-meta">
                            <span class="author-location icon-location"> Seoul, South Korea</span>
                            <span class="author-link icon-link"><a href="https://newwisdom.github.io/"> newwisdom.github.io/</a></span>
                        </div>
                    </section>

                    <!-- /author  -->

                    <section class="share">
                        <h4>Share this post</h4>
                        <a class="icon-twitter" href="http://twitter.com/share?text=🕹 Level 1. 로또 미션 코드 리뷰 정리&amp;url=http://localhost:4000lotto"
                            onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                            <span class="hidden">Twitter</span>
                        </a>
                        <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000lotto"
                            onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                            <span class="hidden">Facebook</span>
                        </a>
                        <a class="icon-google-plus" href="https://plus.google.com/share?url=http://localhost:4000lotto"
                           onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                            <span class="hidden">Google+</span>
                        </a>
                    </section>
                
            

            <!-- Add Disqus Comments -->
            

        </footer>

    </article>

</main>

<aside class="read-next">

    <!-- [[! next_post ]] -->
    
        <a class="read-next-story " style="background-image: url(/assets/images/woowa.jpg)" href="/inheritance">
            <section class="post">
                <h2>📖 상속에 대하여</h2>
                <p>강의시간에 배운 상속 개념에 추가로 공부한 내용을 정리해본다 ✍️ ## 상속 **먼저 상속이란 ?** 기존의...</p>
            </section>
        </a>
    
    <!-- [[! /next_post ]] -->
    <!-- [[! prev_post ]] -->
    
        <a class="read-next-story prev " style="background-image: url(/assets/images/woowa.jpg)" href="/bigdecimal">
            <section class="post">
                <h2>📖 BigDecimal에 관한 고찰</h2>
                <p>이번 미션에서 BigDecimal에 대한 언급이 많았는데, 도대체 그게 뭐지 🤷‍♀️ 나만 몰라 ❓ 에서부터 출발한...</p>
            </section>
        </a>
    
    <!-- [[! /prev_post ]] -->
</aside>

<!-- /post -->


        <!-- The tiny footer at the very bottom -->
        <footer class="site-footer clearfix">
          <section class="copyright"><a href="/">Welcome To New Wisdom's Log !</a> &copy; 2021</section>
          <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> using <a href="https://github.com/jekyller/jasper">Jasper</a></section>
        </footer>
    </div>
    <!-- highlight.js -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- jQuery needs to come before `` so that jQuery can be used in code injection -->
    <script type="text/javascript" src="//code.jquery.com/jquery-1.12.0.min.js"></script>
    <!-- Ghost outputs important scripts and data with this tag -->
    <!--  -->
    <!-- Add Google Analytics  -->
        <!-- Google Analytics Tracking code -->
     <script>
	    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	    ga('create', 'G-09YB1TZP06', 'auto');
	    ga('send', 'pageview');

     </script>
    <!-- Fitvids makes video embeds responsive and awesome -->
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <!-- The main JavaScript file for Casper -->
    <script type="text/javascript" src="/assets/js/index.js"></script>

</body>
</html>
